test_applyAIMS <- function() {
  data(mcgillExample)
  mcgill.aims <- applyAIMS(mcgillExample$D,
                           mcgillExample$EntrezID)

  mcgill.known.aims <- c("Normal","LumA","LumB","Her2","LumA","LumB","Her2","Her2","Her2","Basal","Her2","Her2","Her2","Her2","Basal","Normal","Her2","LumB","Her2","Her2","Normal","LumB","LumA","LumA","Basal","LumA","LumA","Her2","Her2","Her2","Basal","Basal","Basal","Her2","Her2","LumA","Her2","LumA","Her2","Basal","LumA","Basal","Her2","Basal","Normal","LumA","LumA","LumA","LumA","Her2","Normal","LumA","Normal","LumA","LumA","LumA","Basal","LumB","Her2","Normal","LumB","LumA","LumA","LumB","LumA","Her2","LumB","LumB","Her2","Normal","LumB","LumB","LumB","LumA","Her2","Her2","LumB","LumB","LumA","LumB","Basal","LumA","LumB","Her2","LumB","LumB","LumB","Basal","Her2","Her2","Basal","Her2","LumA","Basal","LumB","Normal","LumA","Her2","LumA","Normal","LumA","Her2","Her2","Her2","Normal","LumA","LumB","LumA","Basal","Basal","Basal","Basal","Basal","Basal","Normal","Her2","LumB","LumB","Basal","Basal","Basal","LumB","LumB","Her2","LumB","Her2","Her2","Her2","Her2","LumA","LumA","Normal","Normal","Her2","LumB","Basal","Basal","LumA","LumA","Basal","Basal","Her2","Basal","Basal","Her2","Basal","Her2","LumA","LumA","LumB","LumB","LumB","LumA","Basal","Her2","Her2","Basal","LumA","LumB","LumB","Her2","Normal","LumA","LumA","Her2","LumA","LumA","Basal","LumA","LumA","LumA","LumB","LumB","Basal","Basal","LumB","Basal","LumA","Normal","Basal","LumA","LumA","LumA","Normal","Basal","LumB","LumA","Basal","Basal","Basal","LumA","LumA","LumA","LumB","LumA","LumB","Normal","Normal","Basal","Basal","LumB","LumB","Basal","LumA","LumB","LumA","Normal","Her2","Normal","Her2","Normal","Basal","LumB","LumA","LumA","Normal","Her2","Normal","Basal","Her2","Her2","Basal","LumA","LumB","LumA","Basal","LumB","LumB","LumA","LumA","Normal","Normal","Normal","Normal","LumA","Basal","LumB","Normal","Normal","Normal","LumA","Normal","LumA","Normal","Normal","LumA","LumB","Normal","LumA","LumB","Normal","LumA","Normal","Her2","Basal","LumA","Her2","LumA","LumA","Normal","LumA","LumA","Normal","Normal","LumA","Her2","LumA","LumA","LumA","LumA","LumA","Her2","LumB","Her2","Her2","Her2","Normal","Her2","LumA","LumA","LumA","Normal","LumA","LumA","Her2","LumB","Normal","Normal","LumA","Normal","LumA","LumA","LumA","LumB","Her2","LumA","LumA","LumA","Normal","LumA","Normal","LumB","Her2","Basal","LumA","LumA","LumA","Her2","LumA","Her2","LumB","Basal","LumA","Normal","Normal","Normal","LumA","LumB","LumA","Normal","Normal")
  
  checkEquals(as.character(mcgill.aims$cl[,1]), mcgill.known.aims)
  
  mcgill.known.probs <- c(0.77849,1,0.99295,0.97222,0.99985,0.95334,1,1,1,1,0.98818,1,0.99675,1,1,0.99985,1,1,0.76404,0.99982,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.99991,1,1,0.99664,0.99409,1,0.87096,1,1,1,1,1,0.93383,1,0.92277,1,1,1,0.99974,0.9861,1,0.99999,1,0.98739,0.99522,0.92931,1,1,0.99908,1,1,1,0.75917,0.99999,0.9994,0.99017,1,1,0.99995,1,1,1,1,1,0.99976,1,1,0.9963,0.99969,1,0.99992,0.99999,1,1,1,1,1,0.98179,1,1,1,0.87622,1,0.98445,1,0.88483,1,1,1,0.93349,1,1,0.99988,1,1,1,1,0.99992,1,1,1,0.77624,0.9999,1,1,1,1,1,1,1,1,0.71825,1,1,1,0.99998,1,0.99995,1,1,0.99996,1,1,1,0.70893,1,1,0.99999,1,1,1,1,0.97251,1,1,1,1,0.96345,1,1,1,0.99813,0.95802,1,1,0.90955,1,1,1,0.99992,1,1,1,1,1,0.99961,1,0.99971,0.99999,1,1,1,1,1,1,0.99931,0.93202,1,1,0.99989,1,1,0.99964,1,1,1,0.98718,0.97205,0.99993,0.93553,1,0.99835,1,0.99942,1,1,0.99973,0.99994,1,1,0.99975,1,0.99894,1,0.99792,0.9989,0.98958,1,1,0.99253,1,1,0.64544,1,1,1,1,1,0.54782,0.99998,1,1,0.99989,0.99998,1,1,1,0.99605,0.99999,0.66101,1,1,1,1,1,0.99996,0.99419,1,1,1,0.7318,1,0.99999,0.99993,0.99979,1,1,1,1,1,0.81537,0.99001,1,1,0.97856,0.99978,1,1,1,1,0.99973,0.85538,1,0.81488,0.99998,1,1,0.99999,1,0.99999,0.99991,1,1,0.99503,1,1,1,1,1,0.73714,0.79377,0.99793,1,1,1,1,1,1,0.99996,0.97582,1,0.99872,0.99498,1,1,1,0.98243,1,0.99986,1,0.99832,1,0.93483,0.99996,1,0.98653,0.88581,0.99666,1,1,1,1,1,1,1,1,1)
  
  checkEqualsNumeric(as.numeric(mcgill.aims$prob[,1]), mcgill.known.probs, tolerance=1.0e-5)
}

